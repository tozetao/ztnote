

### rowid

rowid是每个引擎用来唯一标识数据行的信息，它分为几种情况：

- 对于有主键的InnoDB表来说，这个rowid就是主键id
- 对于没有主键的InnoDB表，InnoDB自己会生成一个长度为6字节的rowid来作为主键
- Memory引擎不是索引组织表，我们可以认为它是一个数组，rowid就是这个数组的下标



### 内存临时表

using temporary，表示使用临时表；filesort表示进行了排序操作。一般在查询的记录上再进一步去操作，就会使用临时表。





### 磁盘临时表

如果内存临时表的大小超过了tmp_table_size参数的限制，那么就会使用磁盘临时表。磁盘临时表使用的引擎默认是 InnoDB，是由参数 internal_tmp_disk_storage_engine控制的。

```ini
tmp_table_size
```

该参数定义了内存临时表的大小，单位字节，默认16M。我们可以将该参数值设置得小些，然后执行optimizer查看执行计划。

如果使用了文件临时表，在执行计划中将会有一个临时表转换成文件表的过程：

```json
{
    "converting_tmp_table_to_ondisk": {
        "cause": "memory_table_size_exceeded",
        "tmp_table_info": {
            "table": "intermediate_tmp_table",
            "row_length": 203,
            "key_length": 0,
            "unique_constraint": false,
            "location": "disk (InnoDB)",
            "record_format": "packed"
        }
    }
}
```







将临时表内存空间改小，将排序缓冲区改小，排序单行数据改小，

为什么sort_buffer_size由96变为88











### optimizer

```json
{
    "creating_tmp_table": {
        "tmp_table_info": {
            "table": "intermediate_tmp_table",
            "row_length": 203,
            "key_length": 0,
            "unique_constraint": false,
            "location": "memory (heap)",
            "row_limit_estimate": 5
        }
    }
},
{
    "converting_tmp_table_to_ondisk": {
        "cause": "memory_table_size_exceeded",
        "tmp_table_info": {
            "table": "intermediate_tmp_table",
            "row_length": 203,
            "key_length": 0,
            "unique_constraint": false,
            "location": "disk (InnoDB)",
            "record_format": "packed"
        }
    }
}
```

这里是连接执行的步骤，第一个步骤是表示创建一张内存临时表，第二个步骤表示将临时表转换成磁盘临时表。