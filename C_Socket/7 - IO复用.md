进程向内核注册要监视的文件描述符，在内核发现进程要监视的文件描述符，它们其中有一种或多种IO条件继续的，就通知进程，这种能力被成为IO复用。select、poll和epoo系统调用都支持IO复用。

I/O复用的应用场合：

- 如果一个客户端处理多个描述符，必须使用I/O复用。

- 如果一个服务器既要处理监听套接字，又要处理已连接的套接字，一般会使用I/O复用。

- 如果一个服务器既要处理TCP，又要处理UDP，一般需要使用I/O复用。

I/O复用的优势可以等待多个描述符就绪。



### API

```c
#include <sys/select.h>
#include <sys/time.h>

int select(int maxfd, fd_set *readset, fd_set *writeset, fd_set *exceptset, const struct timeval *timeout);
```

该函数允许进程指定内核要监视的文件描述符，并等待描述符中的多个事件中的任何一个发生，并只有在一个或多个时间发生，或经历一段指定的时间后才唤醒它。

意思是：select告诉内核对哪些描述符进行监视以及等待多长时间，监视的事件有：就读、可写或异常条件。

- timeout

  指定内核等待所指定描述符中任何一个条件就绪的时间，即超时时间。




example:

```c
// 阻塞于select调用，直到有I/O条件继续
int nready = select();

// 遍历监视的文件描述符
for (int i = 3; i < maxfd + 1; i++) {
    //处理I/O条件
}
```





一个输入读取操作包含俩个操作：

- 等待数据准备好
- 从内核向进程复制数据

对于一个套接字上的输入操作，第一步通常涉及等待数据从网络中到达。当所等待分组到达时，它被复制到内核中的某个缓冲区。第二部就是把数据从内核缓冲区复制到进程缓冲区中。
