## Linux用户系统
Linux是一个多用户的操作系统，系统中的任何文件都属于某个用户，而用户又隶属于最少一个组，用户是否有权限对文件的访问都是受限于用户系统的。

### 1. 用户
用户就是一个使用者，例如root用户就是一个使用者，文件的所有者可以对文件进行任何权限设置。
用户的类型可以分为超级用户、系统用户和普通用户。
超级用户即root用户，它的UID是0，系统用户是指一些软件的运行需要提供一个普通用户类型的账号，为了满足这个需求而创建的账号，例如apache、mysql，在安装成功后都会创建一个系统账号的，其UID在1-499之间。
普通用户是自己创建的账号，UID在500至4294967295之间。

### 2. 用户组
将拥有相同权限的用户分为一组，这些用户都会拥有组内的权限。
用户组同样可以划分为超级用户组，系统用户组，用户自定义组。
- 超级用户组：即root用户组
- 系统用户组：系统本身或某些软件需要，由系统定义的群组，GID范围在1-499，主要是给系统安装的软件预留的编号。
- 普通用户组：由用户自身创建的群组，建议GID在500以上。

### 3. passwd
passwd是用户账户文件，位于/etc/passwd，该文件存储了用户的相关信息，每一行数据即是一个用户的信息，用户字段信息以":"分隔，主要用于登录验证。

user : x : 123 : 456 : xxxxx : /home/user : /bin/bash
上面的字段信息从左到右分别对应
用户名：密码(占位符表示)：用户编号：用户组编号：用户注释信息：用户主目录：shell
其中shell即表示登录后要执行的shell命令。

linux是根据/etc/passwd文件的UID和GID来判断用户的文件权限的，所以/etc/group对于文件控制权限并不是必要的。

##### 4. /etc/shadow
该文件主要用于存储系统中所有用户的密码信息，密码信息是加密的。
每行记录代表一个用户的密码信息，也是以:分隔字段信息，如下所示：

username : password : lastchg : min : max : warn : inactive : expire : flag
具体字段信息含义略...

##### 5. /etc/group
存储当前系统用户组的配置信息，文件中每一行记录对应着一个用户组的信息，如下所示：
Group : x : 123 : abc,def,xyz
上面的字段信息从左到右分别对应，组名：组的密码(x是占位符)：组编号：组的用户列表，逗号分隔。
需要注意的是，组用户列表可能为空，例如当用户组和用户名一致的时候就可以省略。

##### 6. /etc/gshadow
存储当前系统中用户组的密码信息。

Group : * :  : abc,def,xyz
组名：组密码：组管理者：组用户列表

注1：组密码如果是*或者空，那么表示没有密码。
注2：组管理者如果是空的话， 组内用户都可以管理组。

##### 7. 相关命令
```
useradd
	用于添加用户。
	useradd [参数] {username}
	-u，指定UID
	-d，指定用户的主目录
	-s，指定用户登录执行的程序
	-r，建立一个系统用户的账号

	-g，定义用户的主要群组，GROUP必须已经存在
	-G，指定用户的次要群组，可以指定多个次要群组，用","相连。
	
	example：
		useradd -g root -d /home/test test
		useradd test
	
	对于没有指定用户组的用户，linux会创建一个同名用户组赋予给它。
	对于没有指定home目录的用户，linux会自动创建。
	
	注：
		出于系统安全考虑，linux系统中的每一个用户除了有其用户名外，
		还有其对应的用户口令，因此还需要用passwd命令为每一位新增加的用户设置口令。
	
	passwd username #设置用户的密码

usermod
	usermod命令用于修改使用者账号信息，大体使用方式同上所示。
	usermod [参数] {username}	
	
	-u UID，修改UID
	-g，GROUP，修改主要群组名称
	-l，修改用户名
	-d，修改用户的home文件夹	
	-s，SHELL，修改可执行程序

	-G，修改次要群组名称
	-L，锁定账号
	-U，接触锁定

userdel
	用于删除系统中的用户信息。


groupadd
	创建用户组
	groupadd [参数] [groupname]
	-g，GID，指定群组账号的标识符
	-r，指定添加的群组称为系统群组
	-f，强制执行，一般情况下groupadd不允许建立一个与使用过的GID相同的群组账号，使用这个参数就会建立相同的GID群组账号

groupmod
	group [参数] [groupname]
	-g，GID，修改群组的id
	-n，newname，修改群组的名称

groupdel
	删除用户组
```

## Linxu权限与文件
通过ls -all命令查看文件列表，大致的属性如下：

|drwxr-x--- | 4	| root | root | 4090 | sep8 14:22 | install.log
|-----------|---|-----|-----|------|-------|------|
|文件类型和权限|链接点|用户|用户组|文件大小|修改日期|文件名称|

##### 1. 文件权限
第1栏中第1个字母代表着文件的类型，后面的字符代表着文件的权限，r是读取，w是写入，x是执行，每3个字符为一组，第一组是用户拥有者的权限，第二组是文件所属组的权限，第三组是其他人的权限。

linux系统的权限只有9个，分别是owner/group/other3种身份各自的read/write/execute权限。

对于文件和目录，r，w，x分别代表不同的意义。

文件时存储数据的地方，包括文本文件、数据库文件、二进制文件等等，都是存储数据的地方，所以linux的权限是针对文件的内容的，可以理解成对文件内容的权限设置，对于文件来说，rwx意义如下：
- r是read，即读，代表数字4
- w是write，即写，代表数字2
- x是execute，是指向，代表数字1

目录是记录文件名列表的地方，文件名跟目录名是有关联的，xrw对于目录意义如下：
- r：具有读取目录的权限，可以查询该目录下的文件列表
- w：建立和删除文件和目录的权限，
- x：目录是不能执行的，x是代表用户是否能进入该目录成为工作目录，如果没有x权限，不仅不能进入目录，同时查看该目录下的文件列表会显示一堆问号。

在centos6.5中，我创建文件的默认权限是644，创建目录的默认权限是755。

example：
```
drwxr--r-- root root 4090 Jun25 9:00 .ssh
# 有一个账号是vbis，该账号不属于root用户组，问该账号对该目录有何种权限?

# vbis具有r权限，因此可以读取该目录，因为不具有x权限，所以不能切换到该目录中，无法切换到该目录下，也就无法执行该目录下的任何指令，即使你具有该目录的r的权限。
#所以要开放目录给人浏览，应该至少给与r以及x权限，但是w权限要谨慎设置。

-rwx------ 1 root  root  4365 Sep 19 23:20  the_root.data
# 账户：vb，该文件属于/home/vb/目录下，vb账户对该目录具有rwx权限。
# 虽然vb账户不能读写这个文件的内容，但是因为vb账户拥有该文件所在目录的w权限，所以是可以删除这个文件的。
```


##### 2. 文件类型
第一组的第一个字符是文件的类型，字符可以是d、-、l、b、c。
- [ d ]是目录
- [ - ]是文件
- [ l ]表示为连结档(link file)；
- [ b ]表示为装置文件里面的可供储存的接口设备(可随机存取装置)；
- [ c ]表示为装置文件里面的串行端口设备，例如键盘、鼠标(一次性读取装置)。

##### 3. 文件归档
##### 3.1 软链接
软链接文件很小，它的时间是文件的创建时间，软链接可以理解成windows的快捷方式，对软链接的操作最终都是对源文件的操作。

##### 3.2 硬链接
用的比较少，硬链接相当于拷贝了一份源文件，不同的是俩个文件的属性和内容是同步更新的，对于其中一方的操作就是对另外一方的操作。

注1：删除是不会对另外一方有影响的。
注2：软链接可以跨文件系统来创建的，硬链接不允许跨文件分区来进行创建。

##### 3.3 i节点
在linux中，文件是由文件名、数据、文件属性组成的。

文件名即文件的名字，文件名保存在名为目录项（dentry）的结构中。
数据即文件存储的内容，而文件属性包括文件类型、权限、链接数、文件创建者、文件所有组、文件的时间信息（创建、修改、被访问）、节点标识，文件的属性信息被称为inode结构。

文件的时间信息包括atime、ctime、mtime，atime是文件被访问时间，mtime指文件内容改变时间，ctime指文件i节点改变信息。

linux内核主要是通过inode的标识去访问对象，inode的标识是一个数字。
```
ls -i filename
#查看文件的i节点标识

stat [option] filename
#查看文件的i节点信息
```

##### 4. 权限相关命令
```
chmod
	改变文件的权限，使用该命令的前提条件是你是文件的所有者。
	用法：
		chmod [-R] xyz 文件目录
		chmod [-R] [a u g o] [+ - =] [r w x] 

	参数说明：
		-R：文件递归执行
		xyz：代表3个数字，是rwx3个权限属性所代表分数的相加。
		[+ - =]：增加、移除、设定
		[a u g o]：
		
	example：
		chmod -R 611 dirname
		
		740  #其他人看不到
		755  #可执行文件，但是其他人不能修改
	
		chmod u=rwx,go=rx name.txt
		//对于name.txt文件，拥有者有rwx权限，组和其他具有读写权限

		chmod a+w name.txt
		//增加所有身份的写入权限

		chmod a-r name.txt
		//剔除所有身份的读取权限

chown
	改变文件的拥有着
	用法：
		chown 	-R 	用户   文件或目录
		chown 	-R 	用户：组名 	文件或目录

chgrp
	改变文件的所属组
	用法：
		chgrp -R groupname filename
	参数说明：
		groupname：组名
		filename：要更改的所属组的文件

chown、chgrp俩个命令只有root用户才有操作权限。	

```